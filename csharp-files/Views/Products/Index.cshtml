@model YameApi.Models.DTOs.ProductListResponse
@{
    ViewData["Title"] = "Sản phẩm";
}

<!-- Page Header -->
<div class="page-header">
    <div class="container">
        <h1 class="page-title">Sản phẩm</h1>
        <p class="section-subtitle">Khám phá toàn bộ bộ sưu tập của chúng tôi</p>
    </div>
</div>

<div class="container products-layout">
    <!-- Filters Sidebar -->
    <aside class="filters-sidebar hidden-mobile">
        <div>
            <h3 class="section-title" style="font-size: 1.125rem; margin-bottom: 1rem;">Bộ lọc</h3>
        </div>

        <!-- Price Range -->
        <div class="filter-section">
            <h4 class="filter-title">Khoảng giá</h4>
            <div class="filter-options">
                <label class="filter-option">
                    <input type="checkbox" class="filter-checkbox" />
                    <span class="filter-label">Dưới 200.000đ</span>
                </label>
                <label class="filter-option">
                    <input type="checkbox" class="filter-checkbox" />
                    <span class="filter-label">200.000đ - 500.000đ</span>
                </label>
                <label class="filter-option">
                    <input type="checkbox" class="filter-checkbox" />
                    <span class="filter-label">500.000đ - 1.000.000đ</span>
                </label>
                <label class="filter-option">
                    <input type="checkbox" class="filter-checkbox" />
                    <span class="filter-label">Trên 1.000.000đ</span>
                </label>
            </div>
        </div>

        <!-- Sizes -->
        <div class="filter-section">
            <h4 class="filter-title">Kích thước</h4>
            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                @foreach (var size in new[] { "S", "M", "L", "XL", "XXL" })
                {
                    <button class="btn" style="padding: 0.5rem; width: 2.5rem; height: 2.5rem; border: 1px solid var(--border);">@size</button>
                }
            </div>
        </div>

        <!-- Colors -->
        <div class="filter-section">
            <h4 class="filter-title">Màu sắc</h4>
            <div class="filter-options">
                @foreach (var color in new[] { "Đen", "Trắng", "Xám", "Navy", "Vàng" })
                {
                    <label class="filter-option">
                        <input type="checkbox" class="filter-checkbox" />
                        <span class="filter-label">@color</span>
                    </label>
                }
            </div>
        </div>

        <!-- Category -->
        <div class="filter-section">
            <h4 class="filter-title">Danh mục</h4>
            <div class="filter-options">
                @foreach (var category in new[] { "Áo", "Quần", "Giày", "Phụ kiện" })
                {
                    <label class="filter-option">
                        <input type="checkbox" class="filter-checkbox" />
                        <span class="filter-label">@category</span>
                    </label>
                }
            </div>
        </div>
    </aside>

    <!-- Products Content -->
    <div class="products-content">
        <!-- Toolbar -->
        <div class="products-toolbar">
            <p class="products-count">Hiển thị @Model.Items.Count() sản phẩm</p>
            
            <div style="display: flex; align-items: center; gap: 0.5rem;">
                <label for="sort" style="font-size: 0.875rem;">Sắp xếp:</label>
                <select id="sort" class="sort-select">
                    <option value="popularity">Phổ biến nhất</option>
                    <option value="price-asc">Giá: Thấp đến cao</option>
                    <option value="price-desc">Giá: Cao đến thấp</option>
                    <option value="newest">Mới nhất</option>
                </select>
            </div>
        </div>

        <!-- Products Grid -->
        <div class="product-grid product-grid-3">
            @foreach (var product in Model.Items)
            {
                var hasDiscount = product.SalePrice.HasValue && product.SalePrice < product.Price;
                var discountPercent = hasDiscount ? Math.Round(((product.Price - product.SalePrice.Value) / product.Price) * 100) : 0;

                <div class="product-card">
                    <a href="/ProductsView/Detail/@product.Id">
                        <div class="product-image-wrapper">
                            <img src="@product.Images.FirstOrDefault()" alt="@product.Title" class="product-image" />
                            @if (hasDiscount)
                            {
                                <span class="product-badge badge-sale">-@discountPercent%</span>
                            }
                            @if (!product.Availability)
                            {
                                <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background-color: rgba(255, 255, 255, 0.8);">
                                    <span class="badge-secondary" style="padding: 0.5rem 1rem;">Hết hàng</span>
                                </div>
                            }
                        </div>
                        
                        <div class="product-info">
                            <div class="product-tags">
                                @foreach (var tag in product.Tags.Take(2))
                                {
                                    <span class="product-tag">@tag</span>
                                }
                            </div>
                            
                            <h3 class="product-title">@product.Title</h3>
                            
                            <p class="product-description">@product.ShortDescription</p>

                            <div class="product-price-wrapper">
                                <span class="product-price">
                                    @((product.SalePrice ?? product.Price).ToString("N0"))đ
                                </span>
                                @if (hasDiscount)
                                {
                                    <span class="product-price-old">@product.Price.ToString("N0")đ</span>
                                }
                            </div>
                        </div>
                    </a>
                    
                    <div class="product-quick-add">
                        <button class="btn btn-icon-only" onclick="event.preventDefault();">
                            <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
                            </svg>
                        </button>
                    </div>
                </div>
            }
        </div>

        <!-- Pagination -->
        <div class="pagination">
            <button class="pagination-btn" disabled>Trước</button>
            <button class="pagination-btn active">1</button>
            <button class="pagination-btn">2</button>
            <button class="pagination-btn">3</button>
            <button class="pagination-btn">Sau</button>
        </div>
    </div>
</div>
